{% extends "base.html" %}
{% block content %}

<!-- ===== Navbar Enhancement for Bright Mode ===== -->
<style>
  nav {
    background: linear-gradient(to right, #ffffff, #f8fafc) !important;
    box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.05);
  }

  nav .nav-container a {
    color: #1e293b !important;
    font-weight: 600;
  }

  nav .nav-container a:hover {
    color: #2563eb !important;
  }

  nav .brand {
    background: linear-gradient(to right, #2563eb, #06b6d4);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
</style>

<!-- ===== Background Video ===== -->
<video autoplay muted loop playsinline id="bg-video"
  class="fixed top-0 left-0 w-full h-full object-cover z-0 opacity-55">
  <source src="{{ url_for('static', filename='videos/skilllink_bg.mp4') }}" type="video/mp4">
</video>

<!-- ===== Dashboard Container ===== -->
<div class="relative z-10 min-h-screen px-6 py-24 flex flex-col items-center">

  <!-- Header -->
  <div class="text-center mb-12">
    <h2 class="text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 via-cyan-400 to-blue-500">
      Client Dashboard
    </h2>
    <p class="text-gray-700 mt-2" style="color: white;">Manage your jobs, applications, and workers easily.</p>
  </div>

  <!-- Applications Section -->
  <div class="w-full max-w-5xl bg-white/95 p-8 mb-12 rounded-2xl shadow-xl border border-gray-200">
    <div class="flex justify-between items-center mb-6">
      <h3 class="text-2xl font-semibold text-indigo-700">ğŸ“‹ Applications</h3>
      <a href="{{ url_for('view_applications') }}"
         class="px-5 py-2 rounded-lg text-white font-semibold bg-gradient-to-r from-indigo-500 to-cyan-400 hover:opacity-90 transition">
        View Applications
      </a>
    </div>

    <!-- Jobs List -->
    <h3 class="text-xl font-semibold text-gray-800 mb-3">Your Jobs</h3>

    {% if jobs %}
      <ul class="space-y-3">
        {% for job in jobs %}
          <li class="p-4 rounded-lg bg-gray-50 border border-gray-200 text-gray-800 flex justify-between items-center hover:bg-gray-100 transition">
            <span class="font-medium">{{ job.title }}</span>
            <span class="px-3 py-1 text-sm rounded-full 
                         {% if job.is_open %}bg-green-100 text-green-700{% else %}bg-red-100 text-red-700{% endif %}">
              {{ "Open" if job.is_open else "Closed" }}
            </span>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="text-gray-600">No jobs posted yet.</p>
    {% endif %}

    <div class="text-center mt-6">
      <a href="{{ url_for('post_job') }}"
         class="inline-block px-6 py-3 rounded-lg bg-gradient-to-r from-indigo-500 to-cyan-400 text-white font-semibold hover:opacity-90 transform hover:scale-[1.02] transition">
        + Post New Job
      </a>
    </div>
  </div>

 <!-- Workers Section -->
<div class="w-full max-w-5xl bg-white/95 p-8 rounded-2xl shadow-xl border border-gray-200">
  <h3 class="text-2xl font-semibold text-indigo-700 mb-6">ğŸ‘· Available Workers</h3>

  {% if workers %}
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      {% for worker in workers %}
        <div class="p-6 rounded-xl bg-gray-50 border border-gray-200 text-gray-800 hover:bg-gray-100 transition duration-300 shadow-md">

  <h3 class="text-xl font-semibold mb-1 text-indigo-600">{{ worker.name }}</h3>

  {% set avg = worker.avg_rating() %}
  {% set count = worker.rating_count() %}
  {% if avg %}
    <p class="text-yellow-500 text-sm mb-2">â­ {{ avg }} ({{ count }} reviews)</p>
  {% else %}
    <p class="text-gray-400 text-sm mb-2">No ratings yet</p>
  {% endif %}

  <p class="text-sm text-gray-600 mb-3"><b>Skills:</b> {{ worker.skills or "Not Provided" }}</p>

  {% set hired = false %}
  {% for hire in hires %}
    {% if hire.worker_id == worker.id and hire.client_id == current_user.id and hire.status == "hired" %}
      {% set hired = true %}
    {% endif %}
  {% endfor %}

  {% if hired %}
    <p class="text-gray-800"><b>Phone:</b> {{ worker.phone }}</p>
    <p class="text-gray-800"><b>Email:</b> {{ worker.email }}</p>

    <div class="flex gap-3 mt-4">
      <a href="{{ url_for('chat', user_id=worker.id) }}"
         class="flex-1 px-4 py-2 rounded-lg bg-gradient-to-r from-indigo-500 to-cyan-400 text-white font-semibold text-center hover:opacity-90 transition">ğŸ’¬ Chat</a>
    </div>

  {% else %}
    <a href="{{ url_for('hire_select_job', worker_id=worker.id) }}"
       class="block w-full mt-3 px-4 py-2 rounded-lg text-center text-white font-semibold bg-gradient-to-r from-green-500 to-emerald-400 hover:opacity-90 transition">
       ğŸ¤ Hire Worker
    </a>
  {% endif %}

  <!-- VIEW PROFILE ALWAYS VISIBLE -->
  <a href="{{ url_for('profile_view', user_id=worker.id) }}"
     class="block w-full mt-3 px-4 py-2 rounded-lg text-center text-white font-semibold bg-gradient-to-r from-indigo-500 to-cyan-400 hover:opacity-90 transition">
     ğŸ‘¤ View Profile
  </a>

</div>

      {% endfor %}
    </div>
  {% else %}
    <p class="text-gray-600">No workers available currently.</p>
  {% endif %}
</div>

<!-- ===== GSAP Animation ===== -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  gsap.from(".w-full", { 
    duration: 1.2, 
    y: 80, 
    opacity: 0, 
    ease: "power4.out", 
    stagger: 0.2 
  });
});
</script>

{% endblock %}
